.........................................................................................
#### Примерный вид дизайна с сильно ограниченной функциональностью ####
> ###### **http://superior0.narod.ru/**данное приложение не является приложением устанавлевоемым на рабочий стол, оно не содержит функциональной начинки, только дизайн. ######
.........................................................................................

# **Описание клиента со стороны камер.** #

# Введение. #

Клиент со стороны камер занимает важное место в общей структуре проекта.
Рассмотрим некую абстрактную схему нашего проекта:
![http://cloudobserver.googlecode.com/svn/wiki/Assets/ObstractCtoCCtoC.png](http://cloudobserver.googlecode.com/svn/wiki/Assets/ObstractCtoCCtoC.png)
Мы видим что Клиент со стороны камер несет в себе важную задачу - сбор
информации с камер и передачу ее на сервера.

# История создания. #

  * Для решения задачи передачи данных с камер на сервер было выбрано писать приложение используя возможности Adobe® AIR™ runtime. Именно эта технология была выбрана из-за нароботанного сообществом Creative Commons (далее если не указанно противное CC) опыта
разработки насыщенных кроссплатформенных приложений в том числе работающих с видео камерами разных стандартов.
  * Приложение должно было соответствовать следующим стандартам.
    1. **Кроссплатформенность** - Работа по меньшей мере на 2х операционных системах разных производителей.
    1. **Самодостаточность** - Возможность работы без установки какого либо дополнительного ПО или Драйверов.
    1. **Быстрота работы** - Минимально возможная нагрузка на канал, минимальная нагрузка на CPU пользователя.
    1. **Простота в использование** - Интуитивно понятный интерфейс, минимальные требования к действиям со стороны пользователя.

# Основные возможности. #

  1. Работа на большинстве распространенных платформ (WINDOWS, MAC OS X, LINUX).
  1. Сбор информации о камерах на машине пользователя.
  1. Сбор информации с камер на машине пользователя.
  1. Работа с несколькими видеокамерами одновременно.
  1. Запись видео.
  1. Возможность сжатия.
  1. Запись по детектору движения.
  1. Соединение с сервером.
  1. Передача данных.

# Описание Основных возможностей. #

## Работа на большинстве распространенных платформ (поддержка WINDOWS, MAC OS X, LINUX). ##

  * Позволяет работать практически с любой машине оснащенной веб камерой или эмулятором последней.
  * Осуществляется за счет платформы разработки Adobe® AIR™ runtime.

## Сбор информации о камерах на машине пользователя. ##

  * Позволяет быстро собрать всю информацию о камерах пользователя для репрезентации и модификации.
  * Используется конструкция ObjectUtil.toString(camera); возвращающая с камеры
такие свойства как:
    1. **(flash.media::Camera)#0**  Элемент к которому применена процедура ObjectUtil
    1. **activityLevel** Порог интенсивности движения, определяемый камерой.
    1. **bandwidth**  Максимальная пропускная способность в байтах, доступная для текущего исходящего видеоканала.
    1. **currentFPS**  Частота, с которой камера записывает данные (в кадрах в секунду).
    1. **fps** Максимальная частота, с которой камера может записывать данные (в кадрах в секунду).
    1. **height**  Текущая высота записи в пикселах.
    1. **index** Целое число, отсчитываемое от нуля, которым задается индекс камеры согласно содержимому массива, возвращаемого свойством "имена".
    1. **keyFrameInterval** Номер видеокадра, который передается целиком (так называемый ключевой кадр), а не подвергается интерполяции по алгоритму сжатия видео.
    1. **loopback** Определяет режим локального представления данных, записываемых камерой: подвергается сжатию и распаковке, как при прямой передаче с помощью Flash Media Server (true), или не подвергается сжатию (false).
    1. **motionLevel** Задает количество движения, необходимое для отправки события activity.
    1. **motionTimeout** Число миллисекунд с момента, когда камера прекратила распознавать движение, до момента передачи события Activity.
    1. **muted** Логическое значение, показывающее, что пользователь запретил (true), или разрешил (false) доступ к камере в диалоговом окне "Конфиденциальность" проигрывателя Flash Player.
    1. **name**  Имя текущей камеры, возвращенное самой камерой.
    1. **quality** Требуемый уровень качества изображения, который определяется степенью сжатия, применяемого к каждому кадру видео.
    1. **width** Текущая ширина записи, в пикселах.

## Сбор информации с камер на машине пользователя. ##

  * Позволяет формативровать данные нужным образом и проводить с ними манипуляции напремер сжатие.
  * Осуществляется методами класса Camera такими как:
    1. **getCamera** Возвращает ссылку на объект Camera для записи видео.
    1. **setKeyFrameInterval** Определяет, какие кадры видео передаются целиком (так называемые ключевые кадры), а не подвергаются интерполяции по алгоритму сжатия видео.
    1. **setLoopback** Определяет, должен ли использоваться сжатый видеопоток для локального представления камеры.
    1. **setMode** Задает для камеры собственный режим записи, наилучшим образом удовлетворяющий заданным требованиям.
    1. **setMotionLevel** Задает количество движения, необходимое для передачи события Activity.
    1. **setQuality** Задает максимальную пропускную способность в секунду или требуемое качество картинки для текущего исходящего видеоканала.

## Работа с несколькими видеокамерами одновременно. ##

  * Позволяет работать с множеством камер на одной машине.
  * Достигается:
    1. извлечением имен камер Camera.names в некий dataProvider.
    1. последовательным применением метода ObjectUtil для каждой камеры.

## Запись видео. ##

  * Позволяет хранить видео на машине пользователя.
  * Достигается переводом BitmapData кадров в JPEG файлы библиотекой  as3corelib классом JPEGEncoder.

## Возможность сжатия. ##

  * Позволяет хранить и передовать файлы не нагружая канал.
  * Достигается библиотекой  as3corelib классом JPEGEncoder параметром 	quality (от 1 до 100).

## Запись по детектору движения. ##

  * Позволяет хранить и передовать только файлы с выбранным количеством изменений относительно предыдущих.
  * Достигается  классом Camera параметром activityLevel.

## Соединение с сервером. ##

  * Позволяет передовать данные.
  * Осуществляется подключением WSDl к среде разработки и дальнейшем использованием возможностей сервиса.

## Передача данных. ##

  * Позволяет серверу обрабатывать и хранить данные.
  * Осуществляется по HTTPS соединяя приложение с SOAP-based web сервисом классом WebService.

# Предпологаемая схема кода программы #


## Получение данных. ##

За получение и формирование данных отвечает функция getCamData.

> ### Функция getCamData. ###
  * Функция открывает возможность свободной работы с данными с камер (сортировка по параметрам итп).
  * Результаты функции можно вывести например в отдельный XML структурированный файл и куда либо передать для дальнейшей работы с камерами.

  * Создаем новый iCollectionView для хранения данных о камерах
    * Создаем новый iViewCursor для дополнения хранилища
  1. Запрос массива Camera.names
  1. Для каждого элемента массива
    1. вызывается метод ObjectUtil.toString(camera);
    1. Создается Array разбиением полученной в (2.1) строки на подстроки функцией split по "Вводам"
    1. Добавляем Array методом insert Cursorа в Collection
  1. Делаем trace нашего iCollectionView для удобства чтения при дебагенге и проверке

> ### Заполнение списка камер информацией ###

  1. Задаем провайдером данных списка созданный (1) iCollectionView
  1. В созданный Costume Item Renderer
    1. Задаем соответствие необходимым к заполнению полям Data dot {Название поля}

## Передача данных. ##

###### раздел в стадии разработки. ######

## Дополнительный функционал ##

###### раздел в стадии разработки. ######

# Предпологаемая схема взаимодействия с облаком. #

  1. **Соединение с сервером.**
    * - Клиент: отправка ника и пароля  сервису.
    * - Сервис: отправка ника и пароля  базе данных.
      1. ответ положителен.
        * - сервис отправка клиенту имени пользователя.
      1. ответ отрицателен.
        * - сервис отправка клиенту предложения повтора операции.

  1. **Отправка запроса на получения ссылки для дальнейшей отправки кадров.**
    * - Клиент: отправка ника, пароля, имени камеры сервису.
    * - Сервис: отправка ника и пароля  базе данных.
      1. ответ положителен.
        * - сервис отправка клиенту ссылки.
      1. ответ отрицателен.
        * - сервис отправка клиенту предложения повтора операции входа в систему.
  1. **Отправка кадра.**
    * - Клиент: отправка кадра формата JPEG сервису.
    * - Сервис: отправка сохранение кадра в базу данных.
      1. ответ положителен.
        * - сервис ожидание нового кадра.
      1. ответ отрицателен.
        * - сервис отправка клиенту сообщения об ошибке.
  1. **приостановка потока кадров от клиента к сервису.**
    * - Клиент: ничего.
    * - Сервис: Ожидание 60 секунд.
    * - сервис отправка клиенту сообщения об отсутствии соединения.

## Эскиз. ##

![http://cloudobserver.googlecode.com/svn/wiki/Assets/Air-WcfScenario.png](http://cloudobserver.googlecode.com/svn/wiki/Assets/Air-WcfScenario.png)

# Предпологаемый вид. #

  * В верхней части.
    1. Кнопки работы с ОС.
    1. Статус соединения.
    1. Статус состояния в системе CloudObserver.
    1. Информация.
    1. Личные настройки.
  * Заголовок.
    1. Логотип.
    1. Имя пользователя.
    1. Информация о приложении.
  * Центр.
    * 2 Списка с камерами на канве.
  * Низ.
    * Дополнительная информация.

## Эскиз. ##

![http://cloudobserver.googlecode.com/svn/wiki/Assets/listAiFirstFinal.jpg](http://cloudobserver.googlecode.com/svn/wiki/Assets/listAiFirstFinal.jpg)